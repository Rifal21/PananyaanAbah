:root {
  --bg-dark: #2c1810; /* Deep Wood/Coffee */
  --bg-darker: #1a0f0a; /* Darker Wood */
  --primary: #d4af37; /* Gold/Bronze */
  --primary-glow: rgba(212, 175, 55, 0.4);
  --secondary: #c04000; /* Terracotta/Brick */
  --accent: #556b2f; /* Olive/Forest Green */
  --text-main: #f3e5ab; /* Parchment/Cream */
  --text-muted: #a89f91; /* Muted Beige */
  --border: rgba(212, 175, 55, 0.2); /* Gold border */
  --glass-bg: rgba(44, 24, 16, 0.85);
  --glass-border: rgba(212, 175, 55, 0.1);

  --sidebar-width: 280px;
  --header-height: 65px;
}

* {
  margin: 0;
  padding: 0;
  box-sizing: border-box;
}

body {
  font-family: "Outfit", "Noto Sans Sundanese", sans-serif;
  background-color: var(--bg-darker);
  color: var(--text-main);
  height: 100vh;
  overflow: hidden;
  background-image:
    linear-gradient(rgba(26, 15, 10, 0.9), rgba(26, 15, 10, 0.9)),
    repeating-linear-gradient(
      45deg,
      rgba(212, 175, 55, 0.03) 0px,
      rgba(212, 175, 55, 0.03) 1px,
      transparent 1px,
      transparent 10px
    ); /* Subtle texture */
}

/* App Container */
.app-container {
  display: flex;
  height: 100%;
}

/* Custom Scrollbar */
::-webkit-scrollbar {
  width: 8px;
  height: 8px;
}

::-webkit-scrollbar-track {
  background: #2c1810;
}

::-webkit-scrollbar-thumb {
  background: #5d4037;
  border: 1px solid var(--bg-darker);
  border-radius: 4px;
}

::-webkit-scrollbar-thumb:hover {
  background: var(--primary);
}

/* For Firefox */
* {
  scrollbar-width: thin;
  scrollbar-color: #5d4037 #2c1810;
}


/* Sidebar */
.sidebar {
  width: var(--sidebar-width);
  background: var(--bg-dark);
  border-right: 1px solid var(--border);
  display: flex;
  flex-direction: column;
  padding: 1rem;
  transition: width 0.3s ease, transform 0.3s ease, left 0.3s ease;
  z-index: 10;
  box-shadow: 2px 0 10px rgba(0,0,0,0.3);
  overflow: hidden; /* Hide content while shrinking */
}

.sidebar.collapsed {
    width: 80px;
    padding: 1rem 0.5rem;
}

.sidebar.collapsed .sidebar-header {
    justify-content: center;
    padding-bottom: 0;
    border-bottom: none;
    flex-direction: column;
    gap: 1rem;
}

.sidebar.collapsed .logo {
    justify-content: center;
}

.sidebar.collapsed .logo-text,
.sidebar.collapsed .history-group h3,
.sidebar.collapsed .history-item span,
.sidebar.collapsed .user-profile span {
    display: none;
}

.sidebar.collapsed .history-item {
    justify-content: center;
    padding: 0.75rem;
}

.sidebar.collapsed .user-profile {
    justify-content: center;
}

.sidebar.collapsed .logo i {
    font-size: 1.75rem;
}

.sidebar-header {
  margin-bottom: 2rem;
  display: flex;
  justify-content: space-between;
  align-items: center;
  padding-bottom: 1rem;
  border-bottom: 1px dashed var(--border);
}

.logo {
  display: flex;
  align-items: center;
  gap: 0.75rem;
  font-weight: 700;
  color: var(--primary);
  letter-spacing: 0.02em;
  white-space: nowrap; /* Prevent wrapping */
}

.logo-text {
  display: flex;
  flex-direction: column;
  line-height: 1.2;
}

.aksara-sunda {
    font-size: 0.75em;
    font-weight: normal;
    font-family: "Noto Sans Sundanese", sans-serif;
    opacity: 0.8;
}

.logo i {
  color: var(--primary);
  font-size: 1.5rem;
  text-shadow: 0 0 10px rgba(212, 175, 55, 0.3);
}

.btn-icon {
  background: transparent;
  border: 1px solid transparent;
  color: var(--text-muted);
  cursor: pointer;
  padding: 0.5rem;
  border-radius: 0.5rem;
  transition: all 0.2s;
  font-size: 1rem;
}

.btn-icon:hover {
  background: rgba(212, 175, 55, 0.1);
  color: var(--primary);
  border-color: var(--border);
}

.history-list {
  flex: 1;
  overflow-y: auto;
}

.history-group h3 {
  font-size: 0.75rem;
  color: var(--text-muted);
  margin-bottom: 0.75rem;
  padding-left: 0.75rem;
  font-weight: 500;
  text-transform: uppercase;
  letter-spacing: 0.05em;
  border-left: 2px solid var(--secondary);
}

/* History Items with Delete */
.history-item-wrapper {
  width: 100%;
  display: flex;
  align-items: center;
  gap: 0.5rem;
  padding: 0.5rem;
  border-radius: 0.5rem;
  transition: all 0.2s;
  margin-bottom: 0.25rem;
  border: 1px solid transparent;
}

.history-item-wrapper:hover {
  background: rgba(212, 175, 55, 0.05);
  border-color: rgba(212, 175, 55, 0.1);
}

.history-item-wrapper.active {
  background: rgba(212, 175, 55, 0.15);
  border: 1px solid var(--primary);
  color: var(--primary);
}

.history-btn {
  flex: 1;
  background: transparent;
  border: none;
  color: inherit;
  cursor: pointer;
  text-align: left;
  font-family: inherit;
  font-size: 0.9rem;
  display: flex;
  align-items: center;
  gap: 0.75rem;
  white-space: nowrap;
  overflow: hidden;
  padding: 0.25rem;
}

.history-btn:hover {
   /* No double hover effect, wrapper handles bg */
   opacity: 0.8;
}

.delete-btn {
    background: transparent;
    border: none;
    color: var(--secondary); /* Red/Terracotta for delete */
    cursor: pointer;
    padding: 0.4rem;
    border-radius: 0.25rem;
    display: flex;
    align-items: center;
    justify-content: center;
    opacity: 0; /* Hidden by default */
    transition: all 0.2s;
}

.history-item-wrapper:hover .delete-btn {
    opacity: 1;
}

/* On mobile, maybe always show delete button if needed? 
   Or rely on tap to hover behaviour (tricky). 
   Let's ensure it has enough space. 
*/
@media (max-width: 768px) {
    .delete-btn {
        opacity: 1; /* Always visible on mobile if sidebar is open */
    }
}

.delete-btn:hover {
    background: rgba(192, 64, 0, 0.2);
}

/* Note: Removed old .history-item styles as they are replaced */

.sidebar-footer {
  margin-top: auto;
  padding-top: 1rem;
  border-top: 1px solid var(--border);
}

.user-profile {
  display: flex;
  align-items: center;
  gap: 0.75rem;
  width: 100%;
  padding: 0.75rem;
  background: rgba(0,0,0,0.2);
  border: 1px solid var(--border);
  color: var(--text-main);
  cursor: pointer;
  border-radius: 0.5rem;
  transition: all 0.2s;
}

.user-profile:hover {
    background: rgba(212, 175, 55, 0.1);
    border-color: var(--primary);
}

.avatar {
  width: 32px;
  height: 32px;
  background: var(--bg-darker);
  border: 1px solid var(--primary);
  border-radius: 50%;
  display: flex;
  align-items: center;
  justify-content: center;
  font-size: 0.9rem;
  color: var(--primary);
}

/* Chat Area */
.chat-area {
  flex: 1;
  display: flex;
  flex-direction: column;
  position: relative;
  background: radial-gradient(
    circle at center,
    rgba(91, 66, 36, 0.2), /* Subtle brown glow */
    transparent 80%
  );
}

/* Sidebar Overlay */
.sidebar-overlay {
  position: fixed;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  background: rgba(0, 0, 0, 0.5);
  z-index: 9;
  backdrop-filter: blur(2px);
}

@media (min-width: 769px) {
  .sidebar-overlay {
    display: none !important;
  }
}

/* Chat Area Header */
.mobile-header {
  display: flex; /* Always show */
  height: var(--header-height);
  align-items: center;
  padding: 0 1rem;
  border-bottom: 1px dashed var(--border);
  background: var(--bg-dark);
}

.brand-group {
    display: flex;
    flex-direction: column;
    margin-left: 0.75rem;
}

.brand {
    font-weight: 700;
    color: var(--primary);
    line-height: 1.1;
}

.mobile-aksara {
    font-size: 0.7em;
    opacity: 0.7;
}

.messages-container {
  flex: 1;
  overflow-y: auto;
  padding: 2rem 1rem;
  display: flex;
  flex-direction: column;
  gap: 1.5rem;
  max-width: 800px;
  margin: 0 auto;
  width: 100%;
  scroll-behavior: smooth;
}

/* Message Styles */
.message {
  display: flex;
  gap: 1rem;
  opacity: 0;
  animation: fadeIn 0.3s forwards;
}

@keyframes fadeIn {
  to {
    opacity: 1;
    transform: translateY(0);
  }
  from {
    opacity: 0;
    transform: translateY(10px);
  }
}

.message.user-message {
  flex-direction: row-reverse;
}

.message-content {
  max-width: 85%;
  padding: 1rem 1.25rem;
  border-radius: 0.75rem;
  line-height: 1.6;
  font-size: 1rem;
  position: relative;
}

.user-message .message-content {
  background: rgba(85, 107, 47, 0.3); /* Olive tint */
  border: 1px solid var(--accent);
  color: var(--text-main);
  border-bottom-right-radius: 0.25rem;
}

.ai-message .message-content {
  background: transparent;
  color: var(--text-main);
  padding-left: 0;
  width: 100%;
}

.ai-header {
    display: flex;
    align-items: center;
    gap: 0.5rem;
    margin-bottom: 0.5rem;
}

.ai-name {
    font-weight: 700;
    color: var(--primary);
    font-size: 1.1rem;
    background: linear-gradient(to right, var(--primary), #e6c86e);
    background-clip: text;
    -webkit-background-clip: text;
    -webkit-text-fill-color: transparent;
}

.ai-message .message-content h2 {
  font-size: 1.5rem;
  margin-bottom: 0.75rem;
  color: var(--primary);
  border-bottom: 1px solid var(--border);
  padding-bottom: 0.25rem;
}

/* Suggestions */
.suggestions {
  display: flex;
  flex-wrap: wrap;
  gap: 0.5rem;
  margin-top: 1.5rem;
}

.suggestion-chip {
  background: rgba(44, 24, 16, 0.6);
  border: 1px solid var(--border);
  color: var(--text-muted);
  padding: 0.5rem 1rem;
  border-radius: 2rem;
  cursor: pointer;
  transition: all 0.2s;
  font-family: inherit;
  font-size: 0.85rem;
}

.suggestion-chip:hover {
  background: rgba(212, 175, 55, 0.1);
  color: var(--primary);
  border-color: var(--primary);
}

/* Markdown Styles */
.prose {
  color: var(--text-main);
}
.prose p {
  margin-bottom: 1em;
}
.prose code {
  background: rgba(0, 0, 0, 0.3);
  padding: 0.2em 0.4em;
  border-radius: 4px;
  font-family: "JetBrains Mono", monospace;
  font-size: 0.9em;
  color: #e6c86e;
}
.prose pre {
  background: #0d0604 !important;
  padding: 1rem;
  border-radius: 0.5rem;
  overflow-x: auto;
  margin: 1rem 0;
  border: 1px solid var(--border);
}
.prose ul,
.prose ol {
  margin-left: 1.5rem;
  margin-bottom: 1rem;
}
.prose strong {
    color: var(--primary);
    font-weight: 600;
}

/* Input Area */
.input-area {
  padding: 1.5rem 1rem 2rem;
  background: linear-gradient(to top, var(--bg-dark), transparent);
}

.input-wrapper {
  max-width: 800px;
  margin: 0 auto;
  position: relative;
  background: var(--bg-darker);
  border: 1px solid var(--border);
  border-radius: 1rem;
  padding: 0.75rem;
  display: flex;
  align-items: flex-end;
  gap: 0.5rem;
  transition: all 0.2s;
  box-shadow: 0 4px 6px rgba(0,0,0,0.3);
}

.input-wrapper:focus-within {
  border-color: var(--primary);
  box-shadow: 0 0 15px rgba(212, 175, 55, 0.1);
}

textarea {
  flex: 1;
  background: transparent;
  border: none;
  color: var(--text-main);
  font-family: inherit;
  font-size: 1rem;
  padding: 0.5rem;
  resize: none;
  max-height: 200px;
  outline: none;
}

textarea::placeholder {
  color: var(--text-muted);
  font-style: italic;
}

.send-btn {
  background: var(--primary);
  color: var(--bg-darker);
  border: none;
  width: 36px;
  height: 36px;
  border-radius: 0.5rem;
  cursor: pointer;
  display: flex;
  align-items: center;
  justify-content: center;
  transition: all 0.2s;
}

.send-btn:disabled {
  background: rgba(255, 255, 255, 0.1);
  color: rgba(255, 255, 255, 0.3);
  cursor: not-allowed;
}

.send-btn:not(:disabled):hover {
  background: #e6c86e;
  transform: translateY(-1px);
}

.disclaimer {
  text-align: center;
  font-size: 0.75rem;
  color: var(--text-muted);
  margin-top: 0.75rem;
  opacity: 0.7;
}

/* Modal */
.modal {
  position: fixed;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  background: rgba(0, 0, 0, 0.85); /* Darker overlay */
  backdrop-filter: blur(5px);
  display: none;
  align-items: center;
  justify-content: center;
  z-index: 1000;
  opacity: 0;
  transition: opacity 0.3s;
}

.modal.active {
  display: flex;
  opacity: 1;
}

.modal-content {
  background: var(--bg-dark);
  width: 90%;
  max-width: 500px;
  border-radius: 1rem;
  border: 1px solid var(--border);
  box-shadow: 0 20px 50px rgba(0, 0, 0, 0.7);
  overflow: hidden;
  transform: translateY(20px);
  transition: transform 0.3s;
}

.modal.active .modal-content {
  transform: translateY(0);
}

.glass-panel {
  background: var(--bg-dark); /* Override glass */
}

.modal-header {
  padding: 1.5rem;
  display: flex;
  justify-content: space-between;
  align-items: center;
  border-bottom: 1px solid var(--border);
}

.modal-header h2 {
    color: var(--primary);
    font-size: 1.25rem;
}

.close-modal {
    background: transparent;
    border: none;
    color: var(--text-muted);
    cursor: pointer;
    font-size: 1.25rem;
}

.modal-body {
  padding: 1.5rem;
}

.modal-footer {
  padding: 1.5rem;
  background: rgba(0, 0, 0, 0.2);
  display: flex;
  justify-content: flex-end;
  border-top: 1px solid var(--border);
}

.input-group {
  display: flex;
  background: rgba(0, 0, 0, 0.3);
  border: 1px solid var(--border);
  border-radius: 0.5rem;
  padding: 0.5rem;
  margin: 1rem 0;
}

.input-group input {
  flex: 1;
  background: transparent;
  border: none;
  color: var(--text-main);
  padding: 0.5rem;
  outline: none;
}

.btn-primary {
  background: var(--primary);
  color: var(--bg-darker);
  border: none;
  padding: 0.75rem 1.5rem;
  border-radius: 0.5rem;
  font-weight: 600;
  cursor: pointer;
  transition: background 0.2s;
}

.btn-primary:hover {
  background: #e6c86e;
}

.help-text {
  font-size: 0.85rem;
  color: var(--text-muted);
}

.help-text a {
  color: var(--primary);
  text-decoration: none;
  border-bottom: 1px dotted var(--primary);
}

/* Tutorial Styles */
.tutorial-toggle {
    background: transparent;
    border: none;
    color: var(--primary);
    display: flex;
    align-items: center;
    gap: 0.5rem;
    cursor: pointer;
    font-size: 0.9rem;
    margin: 1rem 0 0.5rem;
    padding: 0;
    transition: opacity 0.2s;
}

.tutorial-toggle:hover {
    opacity: 0.8;
}

.tutorial-content {
    background: rgba(0, 0, 0, 0.2);
    border: 1px solid var(--border);
    border-radius: 0.5rem;
    padding: 1rem;
    margin-bottom: 1rem;
}

.tutorial-content ol {
    margin-left: 1.5rem;
    color: var(--text-muted);
    font-size: 0.9rem;
}

.tutorial-content li {
    margin-bottom: 0.5rem;
}

.tutorial-content a {
    color: var(--primary);
    text-decoration: none;
    border-bottom: 1px dotted var(--primary);
}

.tutorial-content strong {
    color: var(--text-main);
}

/* Animations */
@keyframes pulse {
  0% {
    opacity: 0.4;
  }
  50% {
    opacity: 1;
  }
  100% {
    opacity: 0.4;
  }
}

.loading-dots span {
  display: inline-block;
  width: 6px;
  height: 6px;
  background: var(--primary);
  border-radius: 50%;
  margin: 0 2px;
  animation: pulse 1.4s infinite;
}

.loading-dots span:nth-child(2) {
  animation-delay: 0.2s;
}
.loading-dots span:nth-child(3) {
  animation-delay: 0.4s;
}

/* Mobile Responsiveness */
@media (max-width: 768px) {
  .sidebar {
    position: fixed;
    left: -100%; /* Off-screen */
    height: 100%;
    /* Override collapsed width on mobile to ensure full transition if needed, 
       but keeping it 80px when off-screen is fine as long as transition works.
       Actually, better to reset width to full when closed on mobile so it doesn't "grow" 
       width while sliding in if we didn't remove collapsed class fast enough.
       But we bound class to the same variable, so it changes instantly.
    */
    box-shadow: 10px 0 20px rgba(0, 0, 0, 0.5);
  }

  /* When showing on mobile, it should be full width of sidebar */
  .sidebar.show {
    left: 0;
    width: var(--sidebar-width) !important; /* Force full width if show is present */
  }
  
  /* If checking specifically for when it is 'collapsed' (closed) on mobile */
  .sidebar.collapsed {
      width: var(--sidebar-width); /* Keep it full width off-screen so no width transition happens during slide */
  }
  
  /* Ensure text is visible if we force width, BUT collapsed class hides text.
     We need to make sure 'collapsed' is NOT applied when we want to see it.
     Logic: sidebarOpen=true => show=true, collapsed=false.
     So when open, it is NOT collapsed. Text shows. Width is normal.
     When closed, it IS collapsed. Text hidden. Width... 
     If we set width to var(--sidebar-width) here for .collapsed, it overrides the 80px.
     So off-screen it is full width.
  */

  .chat-area {
    height: 100vh;
  }

  .messages-container {
    padding-top: 1rem;
  }
}
